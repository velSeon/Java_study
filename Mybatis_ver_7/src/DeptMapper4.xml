<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dept.DeptMapper4">

<select id ="topN" resultType="Dept">
select deptno, dname, loc
from dept order by 1 asc
</select>


<insert id="multinsert" parameterType="java.util.List">
INSERT ALL
<foreach item = "item" index="index" collection ="list">
into dept (deptno, dname, loc)
values(#{item.deptno},#{item.dname}, #{item.loc} )
</foreach>
select * from dual
</insert>


<delete id="multidelete2" parameterType="java.util.List">
delete from dept where deptno IN
<foreach item = "item" index="index" collection ="list" open="("
separator="," close=")">
#{item.deptno} <!-- dept객체의 deptno사용 -->
</foreach>
</delete>


<delete id="multidelete" parameterType="java.util.List">
delete from dept where loc IN
<foreach item = "item" index="index" collection ="list" open="("
separator="," close=")">
#{item}
</foreach>
</delete>



<update id="multiupdate" parameterType="java.util.List">
update dept set loc = '제주' where deptno IN
<foreach item = "item" index="index" collection ="list" open="("
separator="," close=")">
#{item}
</foreach>
</update>

<select id="multiSelect" parameterType="java.util.List" resultType="Dept">
select deptno, dname, loc from dept where deptno in <!--주의 -->
<foreach item ="item" index ="index" collection ="list" open="(" 
separator ="," close = ")">
#{item}
</foreach>
</select>



<select id ="selectDynamicChoose" parameterType="hashmap" resultType="Dept">
select deptno, dname, loc from dept 
 <choose>
 	<when test = "dname != null and loc != null">
		where dname = #{dname} and loc = #{loc}
	</when>
	<when test = "dname != null">
		where dname = #{dname}
	</when>
	<when test = "loc != null">
		where loc = #{loc}
	</when>	
	<otherwise>
		where deptno = 10
	</otherwise>
 </choose>
</select>


</mapper>